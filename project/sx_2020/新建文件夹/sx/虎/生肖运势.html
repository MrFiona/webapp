<!DOCTYPE html>
<!-- saved from url=(0084)https://m.nownow.club/now/animals_res.html?name=888&birth=1987-01-01&gender=0&p=6003 -->
<html lang="zh-cn" style="user-select: none;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no">
    <script src="./生肖运势_files/stats.js" name="MTAH5" sid="500663644" cid="500663645"></script><script>
        document.documentElement.style.webkitUserSelect = 'none';
        document.documentElement.style.webkitTouchCallout = "none";
    </script>
    <meta name="format-detection" content="telephone=no">
    <title>生肖运势</title>
    <link href="./生肖运势_files/common.css" rel="stylesheet">
    <link rel="stylesheet" href="./生肖运势_files/weui.min.css">
    <style type="text/css">
        body {
            background-color: #aa2135;
        }

        .header .bg {
            width: 100%;
        }
        .header .icon {
            position: absolute;
            left: 50%;
            top: 6%;
            width: 147px;
            margin-left: -73px;
        }

        .taisui-card {
            display: none;
            position: relative;
            margin: 30px 30px 0;
            border: 2px solid #e6bc94;
        }
        .taisui-wrapper {
            margin: 7px;
            text-align: center;
            border: 1px solid #e6bc94;
        }
        .taisui-wrapper img {
            width: 85px;
            margin-top: 20px
        }
        .taisui-wrapper p {
            text-align: left;
            font-size: 16px;
            color: #f5c696;
            margin: 5px 15px 20px;
        }

        .desc-card {
            margin: 64px 30px 0;
            border-radius: 6px;
            box-shadow: 0px 2px 38px 0px rgba(185, 72, 59, 0.49);
            padding: 4px 0;
            background: #fff url(/animals/imgs/res_desc_bg.jpg) no-repeat;
            background-size: 100%;
            position: relative;
        }
        .desc-wrapper {
            margin: 4px 8px;
            border-radius: 6px;
            border: 1px solid #ccb385;
            text-align: center;
            padding: 0 12px;
            position: relative;
        }
        .desc-wrapper .title {
            width: 111px;
            margin-top: -50px;
        }
        .desc-wrapper p {
            position: relative;
            text-align: left;
            font-size: 15px;
            color: rgb(72, 72, 72);
            line-height: 1.7;
        }
        .desc-wrapper h3 {
            margin-top: 30px;
            text-align: left;
            font-size: 16px;
            color: #aa2135;
            /*font-weight: normal;*/
        }
        .desc-card .footer {
            position: absolute;
            left: 0;
            bottom: 0;
            width: 100%;
            border-radius: 6px;
        }
        .desc-wrapper .end {
            position: absolute;
            left: 0;
            bottom: 0;
            width: 100%;
        }

        .pay-btn {
            display: none;
            margin: 40px 20px;
            border-radius: 5px;
            box-shadow: 0px 3px 7px 0px rgba(0, 0, 0, 0.27);
            height: 60px;
            color: rgb(170, 33, 53);
            text-align: center;
            background: #f5c696 url(/animals/imgs/pay_btn_bg.png);
            background-size: 110%;
        }
        .pay-btn h3 {
            padding-top: 10px;
            font-size: 19px;
            font-weight: normal;
            line-height: 25px;
        }
        .pay-btn p {
            font-size: 13px;
            text-decoration: line-through;
        }
    </style>
<script></script></head>

<body>
    <div class="mod-page">
        <div class="header">
            <img class="bg" src="./生肖运势_files/res_header_bg.jpg">
            <!-- <img class="icon" src="/animals/imgs/animals/鼠.png"> -->
        <img class="icon" src="./生肖运势_files/虎.png"></div>

        <div style="margin-top: -15%;"></div>

        <div class="taisui-card" style="display: block; transform-origin: 0px 0px 0px; opacity: 1; transform: scale(1, 1);">
            <div class="taisui-wrapper">
                <img src="./生肖运势_files/破太岁.png">
                <p>代表你的生肖与今年太岁相破，意味着你今年在金钱、事业、爱情上的运势都会遭到破坏。</p>
            </div>
        </div>

        <div class="desc-card">
            <img class="footer" src="./生肖运势_files/res_desc_footer.jpg">
            <div class="desc-wrapper">
                <img class="title" src="./生肖运势_files/res_title.png">
                <!-- <p>属鼠人今年的事业运势非常不错，有“天德”、“天乙”二贵人加持，今年鼠属人在事业上易得贵人相帮。对于工薪一族的属鼠人来说，你们今年容易入上司或者领导的青眼，给你们委派比较关键性的任务，做好这些对你们未来的升迁大有助益。对于经商的属鼠人来说，今年你们会碰到赏识你们能力的贵人，他们会给你们介绍比较多资源和人脉，让你们今年在生意上可以获得不错的起色。</p>
                <h3>属鼠人2019年事业运势</h3>
                <p>属鼠人今年的事业运势非常不错，有“天德”、“天乙”二贵人加持，今年鼠属人在事业上易得贵人相帮。对于工薪一族的属鼠人来说，你们今年容易入上司或者领导的青眼，给你们委派比较关键性的任务，做好这些对你们未来的升迁大有助益。</p>
                <img class="end" src="/animals/imgs/res_desc_end.png"> -->
            <p>
                在2019年猪年，属虎人的运势算是比较一般，虽然说寅虎和亥猪是六合属相，理应今年的运势应该很好很顺。
                但是寅亥破合，寅和亥在是相合的属相同时又是相破的属相。破有破坏破损的意思，是说在方方面面的运势上可能会有些许的破损和反复，会有眼看着要成功的事因为种种原因成功不了的事情发生。
                比如你联络了好久的客户，眼看着要签一个大单了，但是突然被竞争对手截胡了。或者是追了半年的姑娘，眼看着要成了，最后突然来个比你更让她心动的人把她抢走了，人俩好了，你绿了。<br><br>
                而且受凶星的影响，属虎人在猪年的人际关系很令人堪忧，所以不管是在职场中还是生活中都要谨慎低调。
            </p>                
            <img class="end" src="./生肖运势_files/res_desc_end.png"></div>
        </div>

        <div class="pay-btn" style="display: block; transform-origin: 0px 0px 0px; opacity: 1; transform: scale(1, 1);">
            <h3>19.9元查看详细运程</h3>
            <p> 原价99元 </p>
        </div>
    </div>
    <script src="./生肖运势_files/zepto.min.js"></script>
    <script src="./生肖运势_files/app.min.js"></script>
    <script type="text/javascript" src="./生肖运势_files/weui.min.js"></script>
    <script src="./生肖运势_files/animals_data.js"></script>
    <script type="text/javascript">
        var pid = app.query('p') || app.defaultAnimalsPID;
        setAnimal2019ShareData(pid);

        var osn = app.query('osn');
        if (osn) {      // 确认h5支付完成
            weui.alert('如您已经支付成功，点击支付完成查看详细运程', {
                title: '请确认支付是否已经完成',
                buttons: [{
                    label: '未支付',
                    type: 'default'
                },{
                    label: '支付完成',
                    type: 'primary',
                    onClick: function() {
                        checkH5PayResult();
                    }
                }]
            });
            function checkH5PayResult() {
                var loading = weui.loading('加载中...');
                var timeId = setInterval(fetchPayResultH5, 2000);
                var tryTimes = 0;
                fetchPayResultH5();
                function fetchPayResultH5() {
                    if (tryTimes >= 5) {
                        loading.hide();
                        clearInterval(timeId);
                        return weui.toast('支付超时', 2000);
                    }
                    tryTimes++;
                    $.ajax({
                        url: '/tenpay/payResult.do',
                        data: {
                            payOrderID: osn
                        },
                        success: function(data) {
                            if (data.state == 'ok') {
                                loading.hide();
                                clearInterval(timeId);
                                window.location.href = '/animals/paid.html?ordersn=' + osn + '&p=' + pid;
                            }
                        }
                    });
                }
            }
        }
        
        var name = app.query('name');
        var birth = app.query('birth');
        var gender = app.query('gender');
        var loading = weui.loading('加载中...');
        $.ajax({
            url: '/shengxiao/overview.do',
            data: {
                name: name,
                birth: birth,
                gender: gender
            },
            success: loadContent,
            complete: function() {
                loading.hide();
            }
        });

        $.ajax({
            url: '/order/getProductPrice.do',
            data: {
                pid: pid
            },
            success: function(res) {
                $('.pay-btn h3').text(res.data.price / 100 + '元查看详细运程');
                $('.pay-btn p').text(' 原价' + res.data.price_origin / 100 + '元 ');
                $('.pay-btn').show();
            }
        });

        function loadContent(res) {
            // console.log(res);
            if (res.state != 'ok') {
                return weui.toast(res.msg, 2000);
            }
            $('.header').append('<img class="icon" src="/animals/imgs/animals/' +  res.data.shengxiao + '.png">');
            // 太岁信息
            var tsDict = taisuiDict(res.data.shengxiao);
            if (tsDict) {
                $('.taisui-wrapper img').attr('src', '/animals/imgs/taisui/' + tsDict.name + '.png');
                $('.taisui-wrapper p').text(tsDict.desc);
                $('.taisui-card').show();
            }
            // 运势文字内容
            $('.desc-wrapper').append('<p>' + res.data.overview.replace(/<br>/g, '<br><br>') + '</p>\
                <img class="end" src="/animals/imgs/res_desc_end.png">');
            

            $('.pay-btn').on('click', function() {
                if (app.getUa.weixin) {
                    submitOrderShengxiao2019();
                } else {
                    submitOrderShengxiao2019H5();
                }
            });

            function submitOrderShengxiao2019() {
                app.needLogin(function(headers, url) {
                    var loading = weui.loading('加载中...');
                    $.ajax({
                        url: url,
                        headers: headers,
                        type: 'POST',
                        data: {
                            name: name,
                            birth: birth,
                            gender: gender,
                            pid: pid
                        },
                        success: function(payRes) {
                            if (payRes.state != 'ok') {
                                return weui.toast(payRes.msg, 2000);
                            }
                            var data = payRes.data;
                            wx.chooseWXPay({
                                timestamp: data.timeStamp,
                                nonceStr:  data.nonceStr,
                                package:   data.package,
                                signType:  data.signType,
                                paySign:   data.paySign,
                                success:   function() {
                                    var ordersn = data.ordersn;
                                    var payLoading = weui.loading('加载中...');
                                    app.needLogin(function(headers, url) {
                                        $.ajax({
                                            url: url,
                                            data: {
                                                payOrderID: ordersn
                                            },
                                            headers: headers,
                                            type: 'post',
                                            success: function(data) {
                                                if (data.state != 'ok') {
                                                    return weui.toast(data.msg, 2000);
                                                }
                                                weui.alert('支付成功！快去查看您的运势吧~', {
                                                    buttons: [{
                                                        label: 'OK',
                                                        onClick: function() {
                                                             window.location.href = '/animals/paid.html?ordersn=' + ordersn + '&p=' + pid;
                                                        }
                                                    }]
                                                });
                                            },
                                            complete: function() {
                                                payLoading.hide();
                                            }
                                        });
                                    }, '/tenpay/payResult.do');
                                },
                                cancel: function(res) {
                                    console.log('cancel pay');
                                }
                            });
                        },
                        complete: function() {
                            loading.hide();
                        }
                    });
                }, '/tenpay/submitOrderShengxiao2019.do');
            }

            function submitOrderShengxiao2019H5() {
                var loading = weui.loading('加载中...');
                $.ajax({
                    url: '/tenpay/submitOrderShengxiao2019H5.do',
                    type: 'POST',
                    data: {
                        name: name,
                        birth: birth,
                        gender: gender,
                        pid: pid
                    },
                    success: function(res) {
                        if (res.state != 'ok') {
                            return weui.toast(res.data.msg, 2000);
                        }
                        var data = res.data;
                        var pageURL = window.location.href;
                        if (pageURL.indexOf('&osn=') != -1 || pageURL.indexOf('?osn=') != -1) {
                            pageURL = app.funcUrlDel('osn');
                        }
                        var redURL = res.data.mweb_url + '&redirect_url=' + encodeURIComponent(pageURL + '&osn=' + res.data.ordersn);
                        window.location.href = redURL;
                    },
                    complete: function() {
                        loading.hide();
                    }
                });
            }
        }
    </script>



</body></html>