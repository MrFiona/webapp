<script src="static/js/jquery-2.2.4.min.js"></script>
<script src="static/js/popper.min.js"></script>
<script src="static/js/bootstrap.min.js"></script>
<script src="static/js/jquery-weui.js"></script>
<!-- Select ticket type -->
{% if page.layout == "index" %}
   <script src="static/js/swiper.js"></script>
   {% include components/swiper/swiperjs.html %}
   {% include fastclickjs.html %}
{% endif %}
<!-- {% if page.layout == "ticketList" %}
<script src="static/js/political_WeCall.js"></script>
<script src="static/js/layui.all.js" type="text/javascript" charset="utf-8"></script>
<script src="static/js/political_WeCall.js"></script>
<script src="static/js/mobiscroll.jquery.min.js"></script>
<script src="static/js/Help.js"></script>
{% endif %} -->
{% if page.layout == "shoppingNew" %}
<script>
function EditCount(m, type) {
    if (type == 'delete') {
        if (confirm("确定删除该商品?")) {
            updateShopping(m, type);
        }
        else {
            return false;
        }
    }
    else {
        updateShopping(m, type);
    }
}
var state = '1';
function updateShopping(m, type) {
    var k = parseInt($('#' + m).val());
    $.get('/Wx/Ticket/EditShopping', { Code: m, type: type }, function (data) {
        var html = '';
        if (data.state == '1') {
            state = '1';
            $(data.data).each(function () {
                html += '<li>\
                <div class="fl in_fl">\
                    <img src="/Wx/Help/GetImage?ImageUrl=' + (this.Ticket == null ? "" : this.Ticket.ImageUrl) + '" alt="">\
                </div>\
                <div class="fr in_fr">\
                    <h2>'+ this.TicketShow.Ticketby.Name + '</h2>\
                    <p>价格：<span class="dol">¥'+ this.TicketShow.DiscountPrice + '</span></p>\
                    <p>使用日期：<span>'+ (new Date(this.TourDate)).Format('yyyy-MM-dd') + '</span></p>\
                    <div>\
                        <div class="piao_type">\
                            <a class="fl del" onclick="EditCount(\'' + this.Code + '\',\'delete\')">删除</a>\
                            <div class="fr Choice">\
                                <button class="' + (this.Qty > 1 ? "fl current" : "fl") + '" onclick="EditCount(\'' + this.Code + '\',\'reduce\')">-</button>\
                                <input class="fl" id="' + this.Code + '" readonly="readonly" type="text" value="' + this.Qty + '">\
                                <button class="' + (this.Qty < 50 ? "fl current" : "fl") + '" onclick="EditCount(\'' + this.Code + '\',\'add\')">+</button>\
                            </div>\
                        </div>\
                    </div>\
                </div>\
            </li>';
            })
        }
        if (data.state == '2') {
            state = '2';
            html = '<li style="border:0; background:0; text-align:center; border-bottom:1px solid #ccc; border-radius:0;">购物车没有商品</li>';
        }
        $('#ticket').html(html);
    })
}
function js() {
    if (state == '1') {
        window.location.href = 'pages/nowPlay.html';
    }
    else {
        alert("您还没有选购任何商品！");
    }
}
</script>
{% endif %}
{% if page.layout == "pages/calendar" %}
<script src="static/js/calendar-price-jquery.js"></script>
<script>
  // 以下mockData是模拟JSON数据，一般情况是从后端(服务器端)获取
  // 对象中'date'字段必须，且格式一定要为0000-00-00
  // 除'date'以为的字段需自定义，然后必须在config:[]中配置
  // 需要在日历中显示参数，需在show:[]中配置
    var mockData = [
        {
            date: "2019-05-30",
            price: "1.200",
            stock: 1000
        },
        {
            date: "2019-05-31",
            price: "12.00",
            stock: 1000
        },
        {
            date: "2019-06-01",
            price: "120.00",
            stock: 2000
        }
    ];
    // 初始化数据
    for (var i = 0; i < 100; i++) {
        mockData.push({
            date: '2019-' + fd(i % 8 + 1) + '-' + fd(randNum(30)),
            price: randNum(i) + '.00',
            stock: i * 21,
            //   buyNumMax: "50",
            //   buyNumMin: "1",
            //   priceMarket: "100.00",
            //   priceSettlement: "90.00",
            //   priceRetail: "99.00"
        });
      }
    // 日历设置参数配置
    var calendarConfig = [
        {
            key: 'price',
            name: '市场价格',
            editable: true
        },
        {
            key: 'stock',
            name: '存库数量',
            deditable: true
        }
      ];
    // 开始日期
    var nowdate = new Date();
    var year = nowdate.getFullYear();
    var month = nowdate.getMonth() + 1;
    var day = nowdate.getDay();
    var begindate = year + '-' + month + '-' + day;
    //配置参数
    var zxCalendar = $.CalendarPrice({
            //显示日历的容器
            el: '.calendar_price',
            // 开始日期
            startDate: begindate,
            // 初始数据
            data: mockData,
            // 日历初始显示的数据
            // 配置需要设置的字段名称
            config:calendarConfig,
            // 配置在日历中要显示的字段
            show: [{key: 'price',name: '¥'}],
            // 自定义颜色
            style: {
                // 头部背景色
                headerBgColor: '#5CC1DE',
                // 头部文字颜色
                headerTextColor: '#fff',
                // 周一至周日背景色，及文字颜色
                weekBgColor: '#5CC1DE',
                weekTextColor: '#fff',
                // 有效日期颜色
                validDateTextColor: '#333',
                validDateBgColor: '#fff',
                validDateBorderColor: '#eee',
                // Hover
                validDateHoverBgColor: '#5CC1DE',
                validDateHoverTextColor: '#fff',
                // 无效日期颜色
                invalidDateTextColor: '#ccc',
                invalidDateBgColor: '#fff',
                invalidDateBorderColor: '#eee'
            },
            callback: function (data) {
                console.log('callback ....');
                console.log(data);
            },
            cancel: function () {
                console.log('取消设置 ....');
                // 取消设置
                // 这里可以触发关闭设置窗口
                // ...
            },
            reset: function () {
                console.log('数据重置成功！');
            },
            error: function (err) {
                console.error(err.msg);
                alert(err.msg);
            },
            // 点击有效的某一触发的回调函数,覆盖掉默认的弹窗
            everyday: function (dayData) {
                console.log('点击某日，返回当天的数据');
                console.log(dayData);
            },
            // 隐藏底部按钮（重置、确定、取消）
            // hideFooterButton: true
    });

    // zxCalendar.$on('submit-form', function(data, next){
    //     console.log(data);
    //     next();
    // });
    // 初始化日期和价格数据
    function randNum(max) {
        return Math.round(Math.random() * max);
    }
    function fd(n) {
        n = n.toString();
        return n[1] ? n : '0' + n;
    }
</script>
{% endif %}
<!-- {% if page.layout == "ticketList" %}
<script>
    $(function () {
        $('.order_all span').click(function (e) {
            $(this).addClass('current').siblings().removeClass('current');
            //$('.order_all ul li').eq($(this).index()).show().siblings().hide();
        });
    })
    var pagelistcount = 3, currentPage = 1, total = 0, state = '32', totalPage = 0;
    var code = '';
    $(function () {
        page(0);
        var type = getQueryString('type');
        code = getQueryString('codes');
        if (type == 'buy') {
            $('#message').show();
        }
    })
    function selectOrder() {
        window.location.href = '/Wx/Ticket/OrderDetails?Code=' + code;
    }

    function subc(s) {
        currentPage = 1;
        state = s;
        page(0);
    }
    function page(m) {
        $.get('/Wx/Ticket/GetBooking', { pagelistcount: pagelistcount, currentPage: currentPage, state: state }, function (data) {
            if (data.status == 'ok') {
                if (data.total == '0') {
                    $('#order').html('');
                    $('#gd').html('无订单！');
                } else {
                    if (m == 0) {
                        $('#order').html('');
                    }
                    total = parseInt(data.totalCount);
                    totalPage = parseInt(data.totalPage);
                    var html = '';
                    $(data.datas).each(function () {
                        var cz = '';
                        switch (this.State) {
                            case 30:
                                break;
                            case 31:
                                cz += '<button onclick="javascript: window.location.href = \'/Wx/Ticket/JsApiPay?OrderNo=' + this.OrderNo + '\'">立即支付</button>';
                                break;
                            case 32:
                                cz += '<a href="/Wx/Ticket/OrderDetails?Code=' + this.Code + '">查看订单</a><button onclick="javascript: window.location.href = \'/Wx/Q?code=' + this.Code + '\'">电子票</button>';
                                break;
                            case 33:
                            case 34:
                                cz += '<a href="/Wx/Ticket/OrderDetails?Code=' + this.Code + '">查看订单</a>';
                                break;
                        }
                        html += '<dl>\
                                <dt class="fl">\
                                    <div class="up">\
                                        <p class="fl">\
                                            购买时间：\
                                            <span>' + this.CreateTime + '</span>\
                                        </p> <i class="fr">' + this.StateName + '</i>\
                                    </div>\
                                    <p>订单信息：</p>'
                        var item = this.OnlineBookingItems;
                        $(item).each(function () {
                            var ks = eval(this.TourDate.replace(/\/Date\((\d+)\)\//gi, "new Date($1)")).Format('yyyy-MM-dd');
                            var js = eval(this.LoseTime.replace(/\/Date\((\d+)\)\//gi, "new Date($1)")).Format('yyyy-MM-dd');
                            var qj = '';
                            if (ks == js) {
                                qj = ks;
                            } else {
                                qj = ks + '至' + js;
                            }
                            html += '<p class="p_main">\
                                        <span>' + this.TicketName + '</span><span>' + qj + '</span> <i>x' + this.Qty + '</i>\
                                    </p>';
                        })
                        html += '<p>订单号：' + this.OrderNo + '</p>\
                                </dt>\
                                <dd class="fr down">\
                                    <div class="fl">订单总额：<span>¥' + this.Amount + '</span></div>\
                                    <div class="fr">' + cz + '</div>\
                                </dd>\
                            </dl>';
                    })
                    if (currentPage < totalPage) {
                        $('#gd').html('更多');
                    }
                    else {
                        $('#gd').html('没有更多');
                    }
                    $('#order').append(html);
                }
            } else {
                alert('订单加载失败！');
            }
        })
    }
    $('#gd').click(function () {
        if (currentPage < totalPage) {
            currentPage++;
            if (currentPage = totalPage) {
                $('#gd').html('没有更多');
            }
            page(1);
        }
    })
 </script>
{% endif %} -->