<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <!-- 避免IE使用兼容模式 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
  <meta name="renderer" content="webkit">
  <!-- TopJUI框架样式 -->
  <link type="text/css" href="../../topjui/themes/default/topjui.core.min.css" rel="stylesheet">
  <link type="text/css" href="../../topjui/themes/default/topjui.blue.css" rel="stylesheet" id="dynamicTheme" />
  <!-- FontAwesome字体图标 -->
  <link type="text/css" href="../../static/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
  <!-- layui框架样式 -->
  <link type="text/css" href="../../static/plugins/layui/css/layui.css" rel="stylesheet" />
  <!-- jQuery相关引用 -->
  <script type="text/javascript" src="../../static/plugins/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="../../static/plugins/jquery/jquery.cookie.js"></script>
  <!-- TopJUI框架配置 -->
  <script type="text/javascript" src="../../static/public/js/topjui.config.js"></script>
  <!-- TopJUI框架核心-->
  <script type="text/javascript" src="../../topjui/js/topjui.core.min.js"></script>
  <!-- TopJUI中文支持 -->
  <script type="text/javascript" src="../../topjui/js/locale/topjui.lang.zh_CN.js"></script>
  <!-- layui框架js -->
  <script type="text/javascript" src="../../static/plugins/layui/layui.js" charset="utf-8"></script>
</head>

<body>
  <script type="text/html" id="toolbarDemo">
    <div class="layui-btn-container">
      <button class="layui-btn layui-btn-normal layui-btn-sm" lay-event="add">添加商品</button>
    </div>
  </script>
  <table id="test" lay-filter="test"></table>
  <script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-sm layui-btn-warm" lay-event="edit">编辑</a>
    <a class="layui-btn layui-btn-sm layui-btn-danger" lay-event="del">删除</a>
  </script>
  <script type="text/html" id="checkboxTpl">
    <input type="checkbox" name="lock" value="{{d.id}}" title="开启" lay-filter="lockDemo" {{ d.id == 10006 ? 'checked' : '' }}>
  </script>
  <!-- 添加产品分类 -->
  <div id="add-main" style="display:none;padding:30px">
    <form class="layui-form" id="add-form" action="">
      <div class="layui-form-item center">
        <label class="layui-form-label">产品编号</label>
        <div class="layui-input-block">
          <input type="text" name="name" required lay-verify="required" value="10080" autocomplete="off"
            style="width:90%" class="layui-input" readonly="readonly" />
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">用户名</label>
        <div class="layui-input-block">
          <input type="text" name="type" required lay-verify="required" placeholder="请输入用户名" autocomplete="off"
            style="width:90%" class="layui-input">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">邮箱</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" placeholder="请输入邮箱地址" autocomplete="off"
            style="width:90%" class="layui-input">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">性别</label>
        <div class="layui-input-block">
          <input type="radio" name="sex" value="男" title="男">
          <input type="radio" name="sex" value="女" title="女">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">城市</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" placeholder="请输入所在城市" autocomplete="off"
            style="width:90%" class="layui-input">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">签名</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" placeholder="请输入签名" autocomplete="off"
            style="width:90%" class="layui-input">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">积分</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" value="2000" autocomplete="off"
            style="width:90%" class="layui-input" readonly="readonly">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">ip</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" value="192.168.30.18" autocomplete="off"
            style="width:90%" class="layui-input" readonly="readonly">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">登入次数</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" value="10" autocomplete="off" style="width:90%"
            class="layui-input" readonly="readonly">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">加入时间</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" value="2019-04-09" autocomplete="off"
            style="width:90%" class="layui-input" readonly="readonly">
        </div>
      </div>
      <div class="layui-form-item">
        <div class="layui-input-block" style="margin-left:50px">
          <button class="layui-btn" lay-submit lay-filter="save">立即提交</button>
          <button type="reset" class="layui-btn layui-btn-primary" id="closeBtn">重置</button>
        </div>
      </div>
    </form>
  </div>

  <!-- 编辑产品分类 -->
  <div id="edit-main" style="display:none;padding:30px">
    <form class="layui-form" id="add-form" action="">
      <div class="layui-form-item center">
        <label class="layui-form-label">ID</label>
        <div class="layui-input-block">
          <input type="text" name="name" required lay-verify="required" value="10080" autocomplete="off"
            style="width:90%" class="layui-input" readonly="readonly" />
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">用户名</label>
        <div class="layui-input-block">
          <input type="text" name="type" required lay-verify="required" value="李白" autocomplete="off" style="width:90%"
            class="layui-input">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">邮箱</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" value="xianxin@layui.com" autocomplete="off"
            style="width:90%" class="layui-input">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">性别</label>
        <div class="layui-input-block">
          <input type="radio" name="sex" value="男" title="男" checked>
          <input type="radio" name="sex" value="女" title="女">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">城市</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" value="惠州市" autocomplete="off"
            style="width:90%" class="layui-input">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">签名</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" value="人生恰似一场修行" autocomplete="off"
            style="width:90%" class="layui-input">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">积分</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" value="2000" autocomplete="off"
            style="width:90%" class="layui-input" readonly="readonly">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">ip</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" value="192.168.30.18" autocomplete="off"
            style="width:90%" class="layui-input" readonly="readonly">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">登入次数</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" value="10" autocomplete="off" style="width:90%"
            class="layui-input" readonly="readonly">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">加入时间</label>
        <div class="layui-input-block">
          <input type="text" name="value" required lay-verify="required" value="2019-04-14" autocomplete="off"
            style="width:90%" class="layui-input" readonly="readonly">
        </div>
      </div>
      <div class="layui-form-item">
        <div class="layui-input-block" style="margin-left:50px">
          <button class="layui-btn" lay-submit lay-filter="save">立即提交</button>
        </div>
      </div>
    </form>
  </div>
  <!-- <script src="src/layui.js" charset="utf-8"></script> -->
  <script>
    layui.use('table', function () {
      var table = layui.table;
      //return;

      //渲染
      window.ins1 = table.render({
        elem: '#test'
        , height: 600
        , url: '../../json/table/demo1.json'
        , toolbar: '#toolbarDemo'
        , title: '用户数据表'
        , cols: [[
          { type: 'checkbox', fixed: 'left' }
          , { field: 'number', title: '产品编号', width: 120, sort: true }
          , { field: 'name', title: '产品名称', width: 150 }
          , { field: 'price', title: '原价格', width: 120 }
          , { field: 'nprice', title: '现价', width: 120, edit: 'text' }
          , { field: 'city', title: '所属地区/国家', width: 150 }
          , { field: 'joinTime', title: '加入时间', width: 150 }
          , { field: 'status', title: '状态', width: 120, templet: '#checkboxTpl', unresize: true}
          , { fixed: 'right', title: '操作', toolbar: '#barDemo', width: 200 }
        ]]
        , page: true
        // ,response: {
        //   statusName: 'status'
        //   ,statusCode: 200
        // }
        // ,parseData: function(res){
        //   return {
        //     "status": res.status
        //     ,"msg": res.message
        //     ,"count": res.total
        //     ,"data": res.data.itme
        //   };
        // }
      });

      //监听行工具事件
      table.on('tool(test)', function (obj) {
        var data = obj.data;
        //console.log(obj)
        if (obj.event === 'del') {
          layer.confirm('真的删除行么', function (index) {
            obj.del();
            layer.close(index);
          });
        } else if (obj.event === 'edit') {
          //  layer.alert('编辑行：<br>'+ JSON.stringify(data))
          layer.open({
            type: 1,
            title: "产品分类编辑",
            closeBtn: 1,
            shift: 2,
            area: ['800px', '700px'],
            shadeClose: true,
            content: $("#edit-main"),
            success: function (layero, index) { },
            yes: function () {
            }
          });
          // layer.prompt({
          //   formType: 2
          //   ,value: data.email
          // }, function(value, index){
          //   obj.update({
          //     email: value
          //   });
          //   layer.close(index);
          // });
        }

      });

      //监听排序
      table.on('sort(test)', function (obj) {
        console.log(this)
        //return;
        layer.msg('服务端排序。order by ' + obj.field + ' ' + obj.type);
        //服务端排序
        table.reload('test', {
          initSort: obj
          //,page: {curr: 1} //重新从第一页开始
          , where: { //重新请求服务端
            key: obj.field //排序字段
            , order: obj.type //排序方式
          }
        });
      });

      //工具栏事件
      table.on('toolbar(test)', function (obj) {
        var checkStatus = table.checkStatus(obj.config.id);
        switch (obj.event) {
          case 'add':
            layer.open({
              type: 1,
              title: "添加产品分类",
              closeBtn: 2,
              shift: 2,
              area: ['800px', '700px'],
              shadeClose: true,
              content: $("#add-main"),
              success: function (layero, index) { },
              yes: function () {
              }
            });
            break;
        };
      });


      //监听排序
      table.on('sort(test)', function (obj) {
        console.log(this)

        //return;
        layer.msg('服务端排序。order by ' + obj.field + ' ' + obj.type);
        //服务端排序
        table.reload('test', {
          initSort: obj
          //,page: {curr: 1} //重新从第一页开始
          , where: { //重新请求服务端
            key: obj.field //排序字段
            , order: obj.type //排序方式
          }
        });
      });

      var $ = layui.jquery, active = {
        // add: function(){
        //   table.addRow('test')
        // },
        reload: function () {
          var demoReload = $('#demoReload');
          //执行重载
          table.reload('testReload', {
            page: {
              curr: 1 //重新从第 1 页开始
            }
            , where: {
              key: {
                id: demoReload.val()
              }
            }
          });
        }
      };

      $('.demoTable .layui-btn').on('click', function () {
        var type = $(this).data('type');
        active[type] ? active[type].call(this) : '';
      });

    });
  </script>
</body>

</html>